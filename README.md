<!-- markdownlint-disable -->

> Tiny supervisor for long running processes with graceful shutdown.

<!-- gomarkdoc:embed:start -->

<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# neosupervisor

```go
import "github.com/byteartis/neosupervisor"
```

## Index

- [Variables](<#variables>)
- [type Option](<#Option>)
  - [func WithTimeout\(timeout int\) Option](<#WithTimeout>)
- [type Options](<#Options>)
- [type Runner](<#Runner>)
- [type RunnerOption](<#RunnerOption>)
  - [func WithRunnerName\(n string\) RunnerOption](<#WithRunnerName>)
- [type Supervisor](<#Supervisor>)
  - [func New\(opts ...Option\) \*Supervisor](<#New>)
  - [func \(a \*Supervisor\) AddRunner\(ctx context.Context, r Runner, opts ...RunnerOption\) error](<#Supervisor.AddRunner>)
  - [func \(a \*Supervisor\) Launch\(launchCtx context.Context\) error](<#Supervisor.Launch>)


## Variables

<a name="ErrApplicationIsRunning"></a>

```go
var (
    // ErrApplicationIsRunning for when application is already running
    ErrApplicationIsRunning = errors.New("application is already running")
    // ErrApplicationAlreadyStopped for when the application is already stopped
    ErrApplicationAlreadyStopped = errors.New("application is stopped and cannot be started again")
)
```

<a name="Option"></a>
## type [Option](<https://github.com/byteartis/neosupervisor/blob/main/options.go#L15>)

Option is a type alias for a functional option that can be passed to the supervisor during its creation.

```go
type Option func(o *Options)
```

<a name="WithTimeout"></a>
### func [WithTimeout](<https://github.com/byteartis/neosupervisor/blob/main/options.go#L19>)

```go
func WithTimeout(timeout int) Option
```

WithTimeout allows to set the timeout for the supervisor. The provided value must be greater than 0 and it will override the default timeout.

<a name="Options"></a>
## type [Options](<https://github.com/byteartis/neosupervisor/blob/main/options.go#L8-L11>)

Options the application's options

```go
type Options struct {
    // contains filtered or unexported fields
}
```

<a name="Runner"></a>
## type [Runner](<https://github.com/byteartis/neosupervisor/blob/main/runner.go#L17-L19>)

Runner is the interface that must be implemented by all background running processes. The method must run while the received context is not cancelled. Returning an error will stop the entire supervisor and cause de application to exit with code 1.

```go
type Runner interface {
    Run(context.Context) error
}
```

<a name="RunnerOption"></a>
## type [RunnerOption](<https://github.com/byteartis/neosupervisor/blob/main/runner.go#L53>)

RunnerOption defines the options that can be passed to the supervisor when adding a new runner

```go
type RunnerOption func(*runnerOptions)
```

<a name="WithRunnerName"></a>
### func [WithRunnerName](<https://github.com/byteartis/neosupervisor/blob/main/runner.go#L56>)

```go
func WithRunnerName(n string) RunnerOption
```

WithRunnerName defines the name of the runner in the options.

<a name="Supervisor"></a>
## type [Supervisor](<https://github.com/byteartis/neosupervisor/blob/main/supervisor.go#L43-L47>)

Supervisor defines the entity responsible for running the different types of components.

```go
type Supervisor struct {
    // contains filtered or unexported fields
}
```

<a name="New"></a>
### func [New](<https://github.com/byteartis/neosupervisor/blob/main/supervisor.go#L24>)

```go
func New(opts ...Option) *Supervisor
```

New creates a new supervisor with the provided options.

<a name="Supervisor.AddRunner"></a>
### func \(\*Supervisor\) [AddRunner](<https://github.com/byteartis/neosupervisor/blob/main/supervisor.go#L50>)

```go
func (a *Supervisor) AddRunner(ctx context.Context, r Runner, opts ...RunnerOption) error
```

AddRunner registers a new runner in the supervisor. Optionally we can attach several options to it.

<a name="Supervisor.Launch"></a>
### func \(\*Supervisor\) [Launch](<https://github.com/byteartis/neosupervisor/blob/main/supervisor.go#L69>)

```go
func (a *Supervisor) Launch(launchCtx context.Context) error
```

Launch will start the supervisor and all its components. It receives a context that when cancelled will also stop all components. Runners will be stopped immediately.

If any failure occurs on Launch it will return an error.

When called multiple times, if the supervisor is stopped will return an error, ottherwise it will immediately return nil. The possible states are: NEW, RUNNING, STOPPING, STOPPED.

Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)


<!-- gomarkdoc:embed:end -->
